<!doctype html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
      <title>Калькуляторы Легенда феникса</title>
      <meta name="viewport" content="width=device-width">
      <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
      <link rel="stylesheet" type="text/css" href="style.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
      <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
      <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
      <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

<!-- Don't use this in production: -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>

  <div id="root"></div>

  <script type="text/babel">
    const container = document.getElementById('root');
    const root = ReactDOM.createRoot(container);
    const levels = [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7];

    class Timer extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          data: {
            level: 0,
            sublevel:0,
            type: 0
          },
          result: null,
          resultBalls: null,
          resultBallsOurs: null
        };
        this.handleChange = this.handleChange.bind(this);
      }

      tick() {
        this.setState(state => ({
          seconds: state.seconds + 1
        }));
      }

      calculateResult() {
        var result = null;
        console.warn(levels);
        console.warn(this.state.data.level);

        var totalPoints =  0;
        for ( var i=1; i < levels.length + 2 - parseInt(this.state.data.level) - 40 + parseInt(this.state.data.type); i++) {
          totalPoints = totalPoints + levels[levels.length - i - 40 + parseInt(this.state.data.type)];
          // levels2.push(levels[levels.length - i]);
        }
        totalPoints = totalPoints - parseInt(this.state.data.sublevel);
        result = totalPoints * 2;
        var resultBalls = Math.floor(totalPoints / 3);
        var resultBallsOurs = (totalPoints % 3) * 2;

        this.setState({
          result: result,
          resultBalls: resultBalls,
          resultBallsOurs: resultBallsOurs
        });
      }

      componentDidMount() {
        // this.interval = setInterval(() => this.tick(), 1000);
      }

      componentWillUnmount() {
        // clearInterval(this.interval);
      }

      handleChange (propertyName, event) {
        const data = this.state.data;
        data[propertyName] = event.target.value;
        this.calculateResult();
        this.setState({ data: data });
      }

        render() {
          return (
            <div className="form-style-3">
            <div div className="chiid-type-input-wrap">
              <div className="chiid-type-input">
              <label for="level"><span>Уровень</span></label>
              <input type="text" name="level" onChange={this.handleChange.bind(this, "level")} value={this.state.data.level}/>
              </div>
              <div className="chiid-type-input">
              <label for="sublevel"><span>Под уровень</span></label>
              <input type="text" name="sublevel" onChange={this.handleChange.bind(this, "sublevel")} value={this.state.data.sublevel}/>
              </div>
</div>
              <label for="type"><span>Тип воспитанника</span></label>
              <select className="chiid-type-select" name="type" value={this.state.data.type} onChange={this.handleChange.bind(this, 'type')}>
                <option value="0">Заурядный (10 ур)</option>
                <option value="10">Одаренный (20 ур)</option>
                <option value="20">Один из тысячи (30 ур)</option>
                <option value="30">Редкий (40 ур)</option>
                <option value="40">Гений (50 ур)</option>
              </select>
              <div className="chiid-result">
              Ребенку осталось расти {this.state.result} часов
              <div>
                Для взросления нужно {this.state.resultBallsOurs === 0 &&
                  <span> ровно </span>
                }
                {this.state.resultBalls} шаров жизненной силы

                {this.state.resultBallsOurs > 0 &&
                  <span> и подождать {this.state.resultBallsOurs} часов</span>
                }
                .

              </div>
              </div>
            </div>
          );
        }
      }


      root.render(React.createElement(Timer, null));

    </script>
  </body>
</html>
